<!DOCTYPE html>
<html>
<head>
	<title>拖拽</title>
	<meta charset="utf-8">
</head>
<body >
	<img src="img/bbb.png">
	<button>显示遮罩</button>
	<div class="mask">
		<div class="cont">
			<div class="title">
			我是弹窗头
			<div class="close">×</div>
			</div>
		</div>		
	</div>
	<!-- <h1 style="background:green;z-index:100;position:absolute;height:2000px">我是标题</h1>
	<span></span> -->
</body>
<style type="text/css">
	*{margin:0px;padding:0px;}
	body{height:1000px;}
	.title{background:orange;height:30px;cursor:move;}
	.close{cursor:pointer;float:right;font-size:18px;background:pink;}
    html{height:100%;}
	.mask{position:absolute;width:100%;height:inherit;background:rgba(0,0,0,0.3);top:0px;/*display:none;*/overflow:hidden;}
	.cont{background:white;height:200px;width:400px;position:absolute;/*left:50%;margin-left:-200px;top:50%;margin-top:-100px;*/}
</style>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript">

	var m = (document.body.clientWidth/2 - g(".cont").offsetWidth/2);
	var n = 200;
	g(".cont").style.left = (document.body.clientWidth/2 - g(".cont").offsetWidth/2)+ "px";
	g(".cont").style.top = "200px";

	$("button").click(function() {
		$(".mask").fadeIn();
		$("html").css("overflow","hidden");
	});
	$(".close").click(function() {
		$(this).parents(".mask").fadeOut();
		$("html").css("overflow","auto");
	});
	function g(obj) {
		return document.querySelector(obj)||"";
	}


	var mouseOffsetX = 0;
	var mouseOffsetY = 0;
	var isDraging = false;

	// 按下

	g(".title").addEventListener("mousedown", function(e) {
		
		// 计算当前位置
		mouseOffsetX = e.pageX - g(".cont").offsetLeft;
		mouseOffsetY = e.pageY - g(".cont").offsetTop;
		isDraging = true;
		// console.log(mouseOffsetX + "::" +mouseOffsetY);
		// console.log(e.clientX + "::" + e.clientY);
	});

	// 移动

	document.onmousemove = function(e) {


		if (isDraging === true) {
			// 计算当前位置
			var x = e.pageX - mouseOffsetX;
			var y = e.pageY - mouseOffsetY;
			g(".cont").style.left =  x + "px";
			g(".cont").style.top =y + "px";
		}
	};

	// 弹起
	document.onmouseup = function() {
		isDraging = false;
	};
</script>
</html>
